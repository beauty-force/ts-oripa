import{o as r,c as a,d as s,H as I,L as z,G as m,r as l,b as c,w as x,F as b,I as g,n as v,f as D,h as p,t as _,e as H}from"./app.ac5a6315.js";import{A as M}from"./Admin.b6baaf3c.js";import{V,r as j,a as B}from"./ArrowLongUpIcon.a962a57a.js";import{_ as N}from"./_plugin-vue_export-helper.cdc0426e.js";import"./useConfirm.a405427d.js";function O(e,t){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"})])}const U={components:{Head:I,AppLayout:M,Link:z,draggable:V,ArrowLongUpIcon:j,ArrowLongDownIcon:B,PaperAirplaneIcon:O},props:{errors:Object,auth:Object,gachas:Object,category_share:Object,shuffle_mode:Boolean},data(){return{enabled:!0,list:this.gachas.data.map(e=>({...e,fixed:e.order_level>1e6})),dragging:!1}},methods:{log(e){this.refresh_list()},refresh_list(){this.list=[...this.list.filter(e=>e.fixed),...this.list.filter(e=>!e.fixed)],this.$nextTick(()=>{this.initializeLazyLoading()})},levelUp(e){let t;for(t=1;t<this.list.length&&this.list[t].id!=e;t++);t<this.list.length&&this.arrayMove(t,t-1),this.refresh_list()},arrayMove(e,t){this.list.splice(t,0,this.list.splice(e,1)[0]),this.refresh_list()},levelDown(e){let t;for(t=0;t<this.list.length-1&&this.list[t].id!=e;t++);t<this.list.length-1&&this.arrayMove(t,t+1),this.refresh_list()},submit(){this.form.gachas=this.list,this.form.post(route("admin.gacha.sorting.store"),{onFinish:()=>{}})},toggle_fix(e){let t;for(t=0;t<this.list.length;t++)if(this.list[t].id==e){this.list[t].fixed^=!0;break}this.refresh_list()},initializeLazyLoading(){const e=document.querySelectorAll("img._lazy"),t={root:null,rootMargin:"0px",threshold:.1},h=i=>{i.src=i.dataset.src},u=new IntersectionObserver((i,n)=>{i.forEach(d=>{d.isIntersecting&&(h(d.target),n.unobserve(d.target))})},t);e.forEach(i=>{u.observe(i)})}},setup(e){const t=m({gachas:[]}),h=m({shuffle_mode:e.shuffle_mode});return{form:t,form_shuffle_mode:h}},mounted(){this.initializeLazyLoading()}},F={class:"mt-2 px-2 md:px-3"},S={class:"p-1 justify-end flex gap-2 items-center"},E=["disabled"],P={class:"inline-block align-middle"},T=s("div",{class:"inline-block align-middle"},"\u4FDD\u5B58\u3059\u308B",-1),$={class:"flex mb-1"},q=["data-src"],G={class:"inline-block text-left align-middle"},J={key:0,class:"bg-green-600 rounded text-xs px-2 mx-1"},K={key:1,class:"bg-neutral-600 rounded text-xs px-2 mx-1"},Q=s("span",{class:"text-white text-sm"},"\u6B8B ",-1),R={class:"text-base"},W={class:"text-white text-xs"},X={key:0,class:"bg-red-600 rounded text-xs px-2 mx-1"},Y=s("span",{class:"text-sm"},"1\u56DE:",-1),Z={class:"align-middle h-full absolute top-0 right-2 flex items-center gap-2"},tt=["onClick"],et=["onClick"],st=["onClick"];function ot(e,t,h,u,i,n){const d=l("Head"),w=l("PaperAirplaneIcon"),k=l("ArrowLongUpIcon"),y=l("ArrowLongDownIcon"),L=l("draggable"),A=l("AppLayout");return r(),a(b,null,[c(d,{title:"\u30AC\u30C1\u30E3\u4E26\u3073\u66FF\u3048"}),c(A,null,{default:x(()=>[s("div",F,[s("div",S,[s("button",{onClick:t[0]||(t[0]=g(o=>n.submit(),["prevent"])),class:v([{"opacity-25":u.form.processing},"w-32 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-normal py-2 px-3 inline-block rounded"]),disabled:u.form.processing},[s("div",P,[c(w,{class:"w-5 h-5 mr-1"})]),T],10,E)]),s("div",$,[c(L,{class:"dragArea list-group w-full",list:i.list,onChange:n.log},{default:x(()=>[(r(!0),a(b,null,D(i.list,(o,C)=>(r(),a("div",{class:"list-group-item bg-neutral-800 m-1 p-1 rounded-md text-left cursor-pointer text-white relative",key:C},[s("img",{"data-src":o.thumbnail,class:"w-24 h-24 inline-block align-middle mr-2 _lazy"},null,8,q),s("div",G,[s("div",null,[o.status==1?(r(),a("span",J,"\u516C\u958B")):p("",!0),o.status==0?(r(),a("span",K,"\u975E\u516C\u958B")):p("",!0)]),s("div",null,[Q,s("span",R,_(o.count_rest),1),s("span",W,"/"+_(o.count_card),1),o.count_rest==0?(r(),a("span",X,"Soldout")):p("",!0)]),s("div",null,[Y,H(),s("span",null,_(o.point)+" pt",1)])]),s("div",Z,[s("button",{onClick:f=>n.toggle_fix(o.id),class:v(["rounded px-2 py-1 text-sm",{"bg-neutral-700 text-white":!o.fixed,"bg-neutral-100 text-rose-500":o.fixed}])},_(o.fixed?"\u9806\u5E8F\u56FA\u5B9A":"\u56FA\u5B9A\u89E3\u9664"),11,tt),s("button",{onClick:g(f=>n.levelUp(o.id),["prevent"]),class:"bg-neutral-700 rounded p-1 hover:bg-neutral-600"},[c(k,{class:"w-6 h-5 text-white block"})],8,et),s("button",{onClick:g(f=>n.levelDown(o.id),["prevent"]),class:"bg-neutral-700 rounded p-1 hover:bg-neutral-600"},[c(y,{class:"w-6 h-5 text-white block"})],8,st)])]))),128))]),_:1},8,["list","onChange"])])])]),_:1})],64)}const ct=N(U,[["render",ot]]);export{ct as default};
