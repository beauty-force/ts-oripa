import{z,l as O,L as B,u as w,E as G,r as g,o as a,c as o,d as e,b as u,w as x,n as b,h as r,t as c,F as j,e as M,Y as A}from"./app.becbe971.js";import{G as F}from"./GachaButtons.40d5b727.js";import{u as H}from"./useConfirm.8f95f8cd.js";import{_ as q}from"./_plugin-vue_export-helper.cdc0426e.js";import{r as R}from"./PlayIcon.d9dfb15e.js";/*! vue-countdown v2.1.2 | (c) 2018-present Chen Fengyuan | MIT */const m=1e3,f=60*m,_=60*f,p=24*_,k="abort",S="end",E="progress",C="start",I="visibilitychange";var U=z({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:s=>s>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:s=>s>=0},transform:{type:Function,default:s=>s}},emits:[k,S,E,C],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0}},computed:{days(){return Math.floor(this.totalMilliseconds/p)},hours(){return Math.floor(this.totalMilliseconds%p/_)},minutes(){return Math.floor(this.totalMilliseconds%_/f)},seconds(){return Math.floor(this.totalMilliseconds%f/m)},milliseconds(){return Math.floor(this.totalMilliseconds%m)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/_)},totalMinutes(){return Math.floor(this.totalMilliseconds/f)},totalSeconds(){return Math.floor(this.totalMilliseconds/m)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(I,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(I,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(C),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const s=Math.min(this.totalMilliseconds,this.interval);if(s>0){let i,t;const d=n=>{i||(i=n),t||(t=n);const l=n-i;l>=s||l+(n-t)/2>=s?this.progress():this.requestId=requestAnimationFrame(d),t=n};this.requestId=requestAnimationFrame(d)}else this.end()},pause(){cancelAnimationFrame(this.requestId)},progress(){!this.counting||(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(E,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(k))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(S))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.update(),this.continue();break;case"hidden":this.pause();break}}},render(){return O(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const{confirm:P}=H(),Y={components:{Link:B,PlayIcon:R,VueCountdown:U,GachaButtons:F},props:{gacha:Object,url_edit:String},data(){return{category_share:w().props.value.category_share,url_card:"",url_10gacha:"",url_1gacha:"",str_gacha10:"",point_10gacha:0,countdown:!0,user:w().props.value.auth.user}},computed:{progress_value(){return Math.round(this.gacha.count_rest*100/this.gacha.count_card)+"%"},progress_background_width(){return this.gacha.count_rest==0?"100%":Math.round(this.gacha.count_card*100/this.gacha.count_rest)+"%"}},methods:{format_number(s){return String(s).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getImageClass(s){return"url('"+s+"')"},clickCard(){this.url_edit||(window.location.href=this.url_card)},destroyGacha(s){P("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F","","error").then(i=>{i&&G.Inertia.delete(route("admin.gacha.destroy",s))})},transform(s){return Object.entries(s).forEach(([i,t])=>{const d=t<10&&i!="days"?`0${t}`:t;t<2&&i.replace(/s$/,""),s[i]=`${d}`}),s}},mounted(){this.gacha.count_rest<10?(this.str_gacha10="\u5168\u3066",this.point_10gacha=this.gacha.count_rest*this.gacha.point):(this.str_gacha10="10\u9023",this.point_10gacha=10*this.gacha.point),this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix)}},J={class:"bg-neutral-800 h-full flex flex-col rounded-lg overflow-hidden relative"},K=["data-src"],Q={key:0,class:"absolute top-3 right-3 z-20"},W=e("svg",{class:"w-6 h-6 mr-2 animate-[spin_2s_linear_infinite]",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1),X={class:"flex flex-col items-center"},Z={key:0,class:"text-xs font-medium mb-0.5"},$={key:1,class:"text-xs font-medium mb-0.5"},tt={key:0,class:"text-base mr-2"},et={class:"font-mono text-base"},st={key:0,class:"absolute z-10 top-3 left-3 px-3 py-1.5 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full font-medium text-sm text-white shadow-sm"},it={key:1,class:"absolute z-10 top-3 left-3 px-3 py-1.5 bg-gradient-to-r from-neutral-500 to-neutral-600 rounded-full font-medium text-sm text-white shadow-sm"},at={class:"absolute z-10 top-3 right-3 flex flex-col gap-2"},ot={key:1,class:"absolute w-full h-full z-10 flex flex-col justify-center items-center gap-6 bg-neutral-900/90 backdrop-blur-sm"},nt={class:"text-white text-4xl md:text-5xl w-full text-center font-black pb-2 font-[mplus2] tracking-wider"},lt={key:2,class:"absolute bottom-0 w-full h-full bg-neutral-900/90 z-[5] flex items-center justify-center"},rt=e("div",{class:"text-white text-2xl md:text-[30px] text-center font-bold px-8 py-4 bg-gradient-to-r from-sky-500 to-sky-600 rounded-xl shadow-lg"},"\u73FE\u5728\u56DE\u305B\u307E\u305B\u3093",-1),ct=[rt],dt={key:3,class:"absolute bottom-0 w-full h-full bg-neutral-900/90 z-10 flex flex-col justify-center items-center gap-4"},ht=e("div",{class:"text-white text-xl w-full text-center font-black"},"\u30E9\u30F3\u30AF\u5236\u9650",-1),ut=e("div",{class:"text-white text-sm w-full text-center font-black"},null,-1),mt=[ht,ut],ft={class:"w-full flex flex-col justify-center flex-1 p-3"},_t={class:"text-white font-[mplus2]"},gt={class:"flex justify-between items-center w-full"},xt={class:"flex items-center gap-2 w-[45%]"},bt=e("div",{class:"bg-white/10 p-1.5 rounded-lg"},[e("img",{src:"/images/icon_cash.png",class:"h-5"})],-1),vt={class:"flex flex-col"},yt={class:"text-white text-base md:text-lg font-bold"},wt=e("span",{class:"text-gray-400 text-xs"},"/ 1\u56DE",-1),Mt={class:"flex-1 flex flex-col items-end gap-2"},pt={key:0,class:"text-white text-xs"},kt={key:1,class:"flex items-center"},St=e("span",{class:"font-medium text-gray-400"},"- / -",-1),Et=[St],Ct={class:"w-full"},It={class:"w-full h-2.5 rounded-full overflow-hidden bg-neutral-400/50"},Nt={key:4,class:"px-3 pb-3"};function Lt(s,i,t,d,n,l){var y;const N=g("vue-countdown"),v=g("Link"),L=g("GachaButtons");return a(),o("div",{class:b(["cursor-pointer w-full overflow-hidden rounded-xl bg-gradient-to-br from-sky-50 to-white p-1.5 shadow-sm hover:shadow-lg transition-all duration-300",{"grayscale-[80%]":!t.url_edit&&t.gacha.count_rest==0,"opacity-75":!t.url_edit&&t.gacha.count_rest==0}])},[e("div",J,[u(v,{href:n.url_card,class:b(["relative group",{"grayscale-[80%]":t.url_edit&&t.gacha.count_rest==0}])},{default:x(()=>[e("img",{"data-src":t.gacha.thumbnail,class:"lazy w-full transition-transform duration-300 group-hover:scale-105"},null,8,K),n.countdown&&t.gacha.remaining>0&&t.gacha.timeStatus<=1?(a(),o("div",Q,[e("div",{class:b(["inline-flex items-center px-4 py-2 rounded-full bg-gradient-to-r text-white shadow-xl border-2 transition-all duration-300",{"from-red-500 to-red-600 border-red-300":t.gacha.timeStatus==1,"from-teal-500 to-teal-600 border-teal-300":t.gacha.timeStatus==0}])},[W,e("div",X,[t.gacha.timeStatus==0?(a(),o("span",Z,"\u958B\u59CB\u307E\u3067")):r("",!0),t.gacha.timeStatus==1?(a(),o("span",$,"\u7D42\u4E86\u307E\u3067")):r("",!0),u(N,{time:t.gacha.remaining*1e3,transform:l.transform,class:"text-base font-black tracking-wider",onEnd:i[0]||(i[0]=h=>n.countdown=!1)},{default:x(({days:h,hours:T,minutes:V,seconds:D})=>[h>0?(a(),o("span",tt,c(h)+"\u65E5",1)):r("",!0),e("span",et,c(T)+":"+c(V)+":"+c(D),1)]),_:1},8,["time","transform"])])],2)])):r("",!0)]),_:1},8,["href","class"]),t.url_edit?(a(),o(j,{key:0},[t.gacha.status==1?(a(),o("div",st," \u516C\u958B ")):(a(),o("div",it," \u975E\u516C\u958B ")),e("div",at,[u(v,{href:t.url_edit,class:"px-6 py-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full font-medium text-sm text-white shadow-sm hover:from-green-600 hover:to-emerald-600 transition-all duration-200"},{default:x(()=>[M(" \u7DE8\u96C6\u3059\u308B ")]),_:1},8,["href"]),e("button",{onClick:i[1]||(i[1]=h=>l.destroyGacha(t.gacha.id)),class:"px-6 py-2 bg-gradient-to-r from-red-500 to-rose-500 rounded-full font-medium text-sm text-white shadow-sm hover:from-red-600 hover:to-rose-600 transition-all duration-200"}," \u524A\u9664 ")])],64)):r("",!0),t.gacha.count_rest==0&&!t.url_edit?(a(),o("div",ot,[e("div",nt,[M(" SOLD OUT "),n.user&&n.user.type==1?(a(),o("button",{key:0,class:"block mx-auto mt-4 text-base font-medium text-white border border-white/30 w-fit rounded-full px-6 py-1.5 hover:bg-white hover:text-neutral-900 transition-all duration-200",onClick:i[2]||(i[2]=h=>l.clickCard())},"\u6392\u51FA\u5C65\u6B74")):r("",!0)])])):r("",!0),t.url_edit&&t.gacha.count_rest!=t.gacha.ableCount?(a(),o("div",lt,ct)):r("",!0),t.gacha.rank_limit>((y=n.user)==null?void 0:y.current_rank)&&!t.url_edit?(a(),o("div",dt,mt)):r("",!0),e("div",ft,[e("div",_t,[e("div",gt,[e("div",xt,[bt,e("div",vt,[e("span",yt,c(l.format_number(t.gacha.point)),1),wt])]),e("div",Mt,[t.gacha.count_card>0?(a(),o("span",pt," \u6B8B\u308A "+c(l.format_number(t.gacha.count_rest))+" / "+c(l.format_number(t.gacha.count_card)),1)):(a(),o("div",kt,Et)),e("div",Ct,[e("div",It,[e("div",{class:"h-full rounded-full bg-gradient-to-r from-sky-400 to-sky-500 transition-all duration-500",style:A(t.gacha.count_card>0?{width:l.progress_value}:{})},null,4)])])])])])]),t.url_edit?r("",!0):(a(),o("div",Nt,[u(L,{gacha:t.gacha},null,8,["gacha"])]))])],2)}const Bt=q(Y,[["render",Lt]]);export{Bt as G};
